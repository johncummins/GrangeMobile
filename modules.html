<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>
	<head>
		<meta charset="utf-8" />
		<title>Grange Mobile</title>
		<!-- <meta name="viewport" content="width=device-width, initial-scale=1" /> -->
		<meta name="viewport" content="initial-scale=1, width=device-width, height=device-height, viewport-fit=cover" />

		<!-- Bootstrap CSS -->
		<link
			href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/css/bootstrap.min.css"
			rel="stylesheet"
			integrity="sha384-BmbxuPwQa2lc/FVzBcNJ7UAyJxM6wuqIj61tLrc4wSX0szH/Ev+nYRRuWlolflfl"
			crossorigin="anonymous"
		/>
		<link href="css/main.css" rel="stylesheet" />
	</head>
	<body>
		<header>
			<h1>Your Modules</h1>
		</header>
		<!-- Card 1 -->
		<div class="card">
			<img src="img/history_digital_media.png" class="card-img-top" alt="..." />
			<div class="card-body">
				<h5 id="module_title1" class="card-title">Card with stretched link</h5>
				<p class="card-text">Some quick example text to build on the card title and make up the bulk of the card's content.</p>
				<!-- <a href="module_info.html" class="btn btn-primary stretched-link" onclick="moduleInfo(1)">Go somewhere</a> -->
				<a href="module_info.html" class="btn btn-primary stretched-link" onclick="setModuleName(1)">Go somewhere</a>
			</div>
		</div>

		<!-- Card 2 -->
		<div class="card" style="margin-bottom: 10%" ;>
			<img src="img/programming_banner.jpg" class="card-img-top" alt="..." />
			<div class="card-body">
				<h5 id="module_title2" class="card-title">Card with stretched link</h5>
				<p class="card-text">Some quick example text to build on the card title and make up the bulk of the card's content.</p>
				<a href="module_info.html" class="btn btn-primary stretched-link" onclick="setModuleName(2)">Go somewhere</a>
			</div>
		</div>

		<div id="change_me" style="margin: 200px">Change me</div>

		<!-- jQuery -->
		<script
			src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
			integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
			crossorigin="anonymous"
		></script>
		<script src="https://code.jquery.com/jquery-1.9.1.js"></script>

		<script>
			// var userID = "123";
			var userID = window.localStorage.getItem("loggedInUser");
			document.getElementById("module_title1").innerHTML = "The user input is: " + userID;

			$(document).ready(function () {
				$.getJSON("http://127.0.0.1:8888/php/json-data-students.php", function (data) {
					$.each(data.students, function (index, student) {
						if (student.studentID == userID) {
							//matches the logged in user with the correct user details
							matchModuleCode(student.moduleNo1, 1); //calling the fucntion to match the module no. with the name
							matchModuleCode(student.moduleNo2, 2);

							// $("#module_title1").append(student.moduleNo1);
						}
					}); //End of Loop
				}); //End of JSON Call
			}); //End of document ready function

			//function that matches the module number with the respective module name
			function matchModuleCode(modCode, num) {
				$.getJSON("http://127.0.0.1:8888/php/json-data-modules.php", function (data) {
					$.each(data.modules, function (index, module) {
						if (module.moduleNo == modCode) {
							if (num == 1) {
								//if a 1 is passed into this paramter as a function then change the first module title
								$("#module_title1").text(module.moduleName);
								//save the 1st module name in local storage under moduleName1
								window.localStorage.setItem("moduleName1", module.moduleName);
							}
							if (num == 2) {
								//same for the 2nd module title
								$("#module_title2").text(module.moduleName);
								//save the 2nd module name in local storage under moduleName2
								window.localStorage.setItem("moduleName2", module.moduleName);
							}
						}
					}); //End of Loop
				}); //End of JSON Call
			}
			function setModuleName(i) {
				// storing either 1 or 2 (corresponding to the module clicked - set in the onclick functin for each card)
				// this is used in module_info.html to see which module has been clicked
				if (i == 1) {
					window.localStorage.setItem("clickedMod", "1");
				} else if (i == 2) {
					window.localStorage.setItem("clickedMod", "2");
				}
			}
		</script>

		<!-- Bottom Nav -->
		<nav class="nav nav-pills fixed-bottom nav-justified" style="height: 60px">
			<a class="nav-item nav-link active" href="#">Modules</a>
			<a class="nav-item nav-link" style="background-color: white" href="#">Locations</a>
			<a class="nav-item nav-link" style="background-color: white" href="profile.html">My Profile</a>
		</nav>

		<!-- jQuery -->
		<script
			src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
			integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
			crossorigin="anonymous"
		></script>

		<!-- Popper and Bootstrap JS -->
		<script
			src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
			integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
			crossorigin="anonymous"
		></script>
		<script
			src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
			integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
			crossorigin="anonymous"
		></script>
	</body>
</html>
